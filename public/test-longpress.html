<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ë¡±í”„ë ˆìŠ¤ ë“œë˜ê·¸ í…ŒìŠ¤íŠ¸</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f3f4f6;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 400px;
      margin: 0 auto;
    }
    
    h1 {
      font-size: 24px;
      margin-bottom: 10px;
      color: #111;
    }
    
    .instruction {
      background: #fef3c7;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
      font-size: 14px;
      line-height: 1.5;
    }
    
    .test-area {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    
    .test-box {
      width: 100%;
      height: 80px;
      background: linear-gradient(135deg, #3b82f6, #2563eb);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 16px;
      position: relative;
      touch-action: none;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
      cursor: pointer;
      transition: all 0.3s;
      overflow: visible;
    }
    
    .test-box.active {
      transform: scale(1.08);
      box-shadow: 0 12px 24px rgba(59, 130, 246, 0.5);
      z-index: 10;
    }
    
    .progress-container {
      position: absolute;
      top: -50px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.9);
      color: white;
      padding: 8px 12px;
      border-radius: 8px;
      white-space: nowrap;
      font-size: 12px;
      display: none;
    }
    
    .progress-container.show {
      display: block;
    }
    
    .progress-bar {
      width: 100px;
      height: 6px;
      background: #374151;
      border-radius: 3px;
      overflow: hidden;
      margin: 4px 0;
    }
    
    .progress-fill {
      height: 100%;
      background: #10b981;
      transition: width 0.05s linear;
    }
    
    .log {
      background: #1f2937;
      color: #d1d5db;
      padding: 15px;
      border-radius: 12px;
      max-height: 400px;
      overflow-y: auto;
      font-size: 13px;
      font-family: 'Courier New', monospace;
    }
    
    .log-entry {
      padding: 6px 0;
      border-bottom: 1px solid #374151;
    }
    
    .log-entry:last-child {
      border-bottom: none;
    }
    
    .status {
      margin-bottom: 15px;
      padding: 12px;
      background: #e0f2fe;
      border-radius: 10px;
      text-align: center;
      font-size: 15px;
      font-weight: 600;
      color: #0c4a6e;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ§ª ë¡±í”„ë ˆìŠ¤ ë“œë˜ê·¸ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="instruction">
      <strong>í…ŒìŠ¤íŠ¸ ë°©ë²•:</strong><br>
      1. íŒŒë€ ë°•ìŠ¤ë¥¼ 0.5ì´ˆ ë™ì•ˆ ëˆ„ë¥´ì„¸ìš”<br>
      2. ì§„í–‰ë¥  ë°”ê°€ í‘œì‹œë©ë‹ˆë‹¤<br>
      3. í–…í‹± í”¼ë“œë°± í›„ ë“œë˜ê·¸ ê°€ëŠ¥<br>
      4. ì½˜ì†” ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”
    </div>
    
    <div class="test-area">
      <div class="test-box" id="testBox">
        <div class="progress-container" id="progressContainer">
          <div>ë¡±í”„ë ˆìŠ¤ ì§„í–‰ ì¤‘...</div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div id="progressText">0.0ì´ˆ</div>
        </div>
        <span id="boxText">3ì´ˆ ëˆ„ë¥´ì„¸ìš”</span>
      </div>
      
      <div class="status" id="status">
        ëŒ€ê¸° ì¤‘... íŒŒë€ ë°•ìŠ¤ë¥¼ 0.5ì´ˆê°„ ëˆ„ë¥´ì„¸ìš”
      </div>
    </div>
    
    <div class="log" id="log">
      <div class="log-entry">ğŸš€ í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ. íŒŒë€ ë°•ìŠ¤ë¥¼ 0.5ì´ˆê°„ ëˆŒëŸ¬ë³´ì„¸ìš”!</div>
    </div>
  </div>

  <script>
    const testBox = document.getElementById('testBox');
    const progressContainer = document.getElementById('progressContainer');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    const status = document.getElementById('status');
    const log = document.getElementById('log');
    const boxText = document.getElementById('boxText');
    
    let longPressTimer = null;
    let progressInterval = null;
    let startPos = null;
    let isDraggable = false;
    let isDragging = false;
    
    const LONG_PRESS_DELAY = 500; // 0.5ì´ˆë¡œ ë‹¨ì¶•
    
    function addLog(message, type = 'info') {
      const entry = document.createElement('div');
      entry.className = 'log-entry';
      const icon = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warn' ? 'âš ï¸' : 'ğŸ“';
      entry.textContent = `[${new Date().toLocaleTimeString()}] ${icon} ${message}`;
      log.prepend(entry);
      console.log(`[LongPress] ${message}`);
    }
    
    function updateStatus(text, color = '#e0f2fe') {
      status.textContent = text;
      status.style.background = color;
    }
    
    function cleanup() {
      if (longPressTimer) {
        clearTimeout(longPressTimer);
        longPressTimer = null;
      }
      if (progressInterval) {
        clearInterval(progressInterval);
        progressInterval = null;
      }
      progressContainer.classList.remove('show');
      progressFill.style.width = '0%';
      testBox.classList.remove('active');
      testBox.style.transform = '';
      boxText.textContent = '3ì´ˆ ëˆ„ë¥´ì„¸ìš”';
      isDraggable = false;
      isDragging = false;
      startPos = null;
    }
    
    function handleStart(e) {
      addLog('í„°ì¹˜/ë§ˆìš°ìŠ¤ ì‹œì‘');
      updateStatus('ë¡±í”„ë ˆìŠ¤ ëŒ€ê¸° ì¤‘... (0.5ì´ˆ)', '#fff7ed');
      
      // ì‹œì‘ ìœ„ì¹˜ ì €ì¥
      if (e.type === 'touchstart') {
        startPos = { x: e.touches[0].clientX, y: e.touches[0].clientY };
        addLog('í„°ì¹˜ ì´ë²¤íŠ¸ ê°ì§€');
      } else {
        startPos = { x: e.clientX, y: e.clientY };
        addLog('ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ê°ì§€');
      }
      
      isDraggable = false;
      isDragging = false;
      
      // ì§„í–‰ë¥  í‘œì‹œ
      progressContainer.classList.add('show');
      const startTime = Date.now();
      progressInterval = setInterval(() => {
        const elapsed = Date.now() - startTime;
        const progress = Math.min((elapsed / LONG_PRESS_DELAY) * 100, 100);
        progressFill.style.width = progress + '%';
        progressText.textContent = (elapsed / 1000).toFixed(1) + 'ì´ˆ';
      }, 50);
      
      // ë¡±í”„ë ˆìŠ¤ íƒ€ì´ë¨¸
      longPressTimer = setTimeout(() => {
        addLog('ë¡±í”„ë ˆìŠ¤ ì™„ë£Œ! ë“œë˜ê·¸ í™œì„±í™”', 'success');
        updateStatus('âœ… ë“œë˜ê·¸ ê°€ëŠ¥! ì´ë™í•´ë³´ì„¸ìš”', '#dcfce7');
        isDraggable = true;
        testBox.classList.add('active');
        boxText.textContent = 'ë“œë˜ê·¸í•˜ì„¸ìš” â†’';
        
        clearInterval(progressInterval);
        progressContainer.classList.remove('show');
        
        // í–…í‹± í”¼ë“œë°±
        if ('vibrate' in navigator) {
          navigator.vibrate(100);
          addLog('í–…í‹± í”¼ë“œë°± ë°œìƒ (100ms)', 'success');
        } else {
          addLog('í–…í‹± í”¼ë“œë°± ë¯¸ì§€ì› (ë°ìŠ¤í¬í†±)', 'warn');
        }
      }, LONG_PRESS_DELAY);
    }
    
    function handleMove(e) {
      if (!startPos) return;
      
      let currentX, currentY;
      if (e.type === 'touchmove') {
        currentX = e.touches[0].clientX;
        currentY = e.touches[0].clientY;
      } else {
        currentX = e.clientX;
        currentY = e.clientY;
      }
      
      const deltaX = currentX - startPos.x;
      const deltaY = currentY - startPos.y;
      const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
      
      // 15px ì´ìƒ ì´ë™ ì‹œ ë¡±í”„ë ˆìŠ¤ ì·¨ì†Œ
      if (distance > 15 && !isDragging && !isDraggable) {
        addLog(`ë¡±í”„ë ˆìŠ¤ ì·¨ì†Œ (ì´ë™: ${distance.toFixed(1)}px)`, 'error');
        updateStatus('âŒ ë¡±í”„ë ˆìŠ¤ ì·¨ì†Œë¨ (ë„ˆë¬´ ë§ì´ ì›€ì§ì„)', '#fee2e2');
        cleanup();
        return;
      }
      
      // ë“œë˜ê·¸ ê°€ëŠ¥ ìƒíƒœì´ë©´ ì´ë™
      if (isDraggable || isDragging) {
        if (!isDragging) {
          addLog('ë“œë˜ê·¸ ì‹œì‘!', 'success');
          isDragging = true;
        }
        
        // ìŠ¤í¬ë¡¤ ë°©ì§€
        if (e.cancelable) {
          e.preventDefault();
        }
        
        // ì‹¤ì œ ì´ë™ (ì‹œë®¬ë ˆì´ì…˜)
        testBox.style.transform = `translateX(${deltaX}px) scale(1.08)`;
        updateStatus(`ğŸ¯ ë“œë˜ê·¸ ì¤‘... (X: ${deltaX.toFixed(0)}px, Y: ${deltaY.toFixed(0)}px)`, '#dbeafe');
      }
    }
    
    function handleEnd() {
      addLog('í„°ì¹˜/ë§ˆìš°ìŠ¤ ì¢…ë£Œ');
      
      if (isDragging) {
        addLog('ë“œë˜ê·¸ ì™„ë£Œ!', 'success');
        updateStatus('âœ… ë“œë˜ê·¸ ì™„ë£Œ! ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”', '#dcfce7');
      } else {
        updateStatus('ëŒ€ê¸° ì¤‘... íŒŒë€ ë°•ìŠ¤ë¥¼ 0.5ì´ˆê°„ ëˆ„ë¥´ì„¸ìš”', '#e0f2fe');
      }
      
      cleanup();
    }
    
    // í„°ì¹˜ ì´ë²¤íŠ¸ (Non-passiveë¡œ ë“±ë¡)
    testBox.addEventListener('touchstart', handleStart, { passive: false });
    document.addEventListener('touchmove', handleMove, { passive: false });
    document.addEventListener('touchend', handleEnd, { passive: false });
    document.addEventListener('touchcancel', handleEnd, { passive: false });
    
    // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
    testBox.addEventListener('mousedown', (e) => {
      handleStart(e);
      
      function onMove(e) {
        handleMove(e);
      }
      
      function onUp() {
        handleEnd();
        document.removeEventListener('mousemove', onMove);
        document.removeEventListener('mouseup', onUp);
      }
      
      document.addEventListener('mousemove', onMove);
      document.addEventListener('mouseup', onUp);
    });
    
    addLog('í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì™„ë£Œ', 'success');
    addLog('íŒŒë€ ë°•ìŠ¤ë¥¼ 0.5ì´ˆê°„ ëˆ„ë¥´ê³  ìˆìœ¼ì„¸ìš”!');
  </script>
</body>
</html>
