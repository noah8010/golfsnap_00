# GolfSnap - 웹 서비스 개발 명세서

> **문서 버전**: v1.0
> **작성일**: 2026-02-09
> **프로토타입**: https://noah8010.github.io/golfsnap_00/
> **대상 독자**: 프론트엔드/백엔드 개발자
> **표기 규칙**: `[TBD]` = 기획 확정 필요, `[스크린샷]` = 첨부 예정

---

## 목차

1. [서비스 개요](#1-서비스-개요)
2. [기술 요구사항](#2-기술-요구사항)
3. [공통 사항](#3-공통-사항)
4. [P1. 대시보드](#p1-대시보드)
5. [P2. 비율 선택](#p2-비율-선택)
6. [P3. 미디어 선택](#p3-미디어-선택)
7. [P4. AI 처리](#p4-ai-처리)
8. [P5. 영상 에디터](#p5-영상-에디터)
9. [P6. 내보내기](#p6-내보내기)
10. [화면 전환 흐름도](#화면-전환-흐름도)
11. [데이터 모델](#데이터-모델)
12. [API 명세](#api-명세)
13. [에러 처리](#에러-처리)

---

## 1. 서비스 개요

### 1.1 서비스 정의

GolfSnap은 스크린골프 이용자를 위한 **모바일 영상 편집 웹앱**입니다.
스크린골프 시뮬레이터에서 기록된 스윙 영상과 샷 분석 데이터를 활용하여, 사용자가 하이라이트 영상을 쉽게 편집하고 공유할 수 있도록 합니다.

### 1.2 타겟 환경

| 항목 | 스펙 |
|------|------|
| 플랫폼 | 모바일 웹 (추후 앱 래핑 가능) |
| 기준 해상도 | 393 x 852px (iPhone 14 Pro) |
| 최소 지원 | iOS Safari 15+, Chrome Android 90+ |
| 화면 방향 | 세로(Portrait) 고정 |
| 터치 지원 | 필수 (마우스 폴백 지원) |
| 오프라인 | 미지원 (항상 네트워크 필요) |

### 1.3 사용자 플로우 요약

```
[로그인] → [대시보드] → [새 프로젝트: 비율 선택 → 미디어 선택 → AI 처리] → [에디터] → [내보내기]
                │                                                              ↑
                └──────────── 기존 프로젝트 선택 ──────────────────────────────┘
```

---

## 2. 기술 요구사항

### 2.1 프론트엔드

| 항목 | 요구사항 |
|------|---------|
| 프레임워크 | React 18+ (SPA) |
| 언어 | TypeScript strict 모드 |
| 상태 관리 | Zustand (또는 동등 경량 라이브러리) |
| 스타일 | Tailwind CSS (다크 모드: class 전략) |
| 애니메이션 | Framer Motion |
| 영상 재생 | HTML5 `<video>` + Media Source Extensions `[TBD: HLS.js 필요 여부]` |
| 영상 처리 | `[TBD: 클라이언트 WebCodecs vs 서버사이드 FFmpeg]` |

### 2.2 백엔드 (필요 API)

| 항목 | 요구사항 |
|------|---------|
| 인증 | `[TBD: OAuth 소셜 로그인 or 자체 회원가입]` |
| 파일 스토리지 | S3 호환 오브젝트 스토리지 (영상/이미지/썸네일) |
| 영상 렌더링 | `[TBD: 서버사이드 FFmpeg 파이프라인 or 클라이언트 처리]` |
| 데이터베이스 | 사용자, 프로젝트, 미디어 메타데이터 저장 |
| CDN | 미디어 파일 서빙 |

### 2.3 미디어 제약 조건

| 항목 | 제한값 | 비고 |
|------|--------|------|
| 업로드 가능 포맷 | MP4, MOV, WEBM, JPG, PNG, HEIC | `[TBD: 추가 포맷]` |
| 단일 파일 최대 크기 | `[TBD: 예상 500MB]` | 서버 설정에 따라 |
| 영상 최대 길이 | `[TBD: 예상 10분]` | |
| 영상 최대 해상도 | 3840x2160 (4K) | |
| 프로젝트당 최대 미디어 수 | `[TBD: 예상 20개]` | |
| 프로젝트 최대 타임라인 길이 | `[TBD: 예상 5분]` | |
| 트랙별 최대 클립 수 | `[TBD: 예상 무제한]` | 성능에 따라 제한 가능 |
| 사용자당 최대 프로젝트 수 | `[TBD]` | |
| 총 스토리지 용량 | `[TBD]` | 요금제별 차등 가능 |

---

## 3. 공통 사항

### 3.1 인증 `[TBD]`

> 프로토타입에는 인증이 구현되어 있지 않습니다. 실 서비스에서는 로그인 필수입니다.

- 비로그인 사용자 → 로그인 페이지로 리다이렉트
- 세션 만료 시 → 작업 중 데이터 임시 저장 후 재로그인 유도
- 인증 방식: `[TBD: 소셜 로그인(카카오/네이버/구글) 또는 자체 회원가입]`

### 3.2 하단 네비게이션

> [스크린샷: 하단 네비게이션 바]

5개 탭으로 구성된 하단 고정 네비게이션입니다.

| 탭 | 아이콘 | 라벨 | 대상 화면 | 비고 |
|----|--------|------|----------|------|
| 홈 | Home | 홈 | 홈 | `[TBD: 기획 미확정]` |
| 탐색 | Compass | 탐색 | 샷 기록 목록 | `[TBD: 기획 미확정]` |
| **만들기** | **Plus** | **만들기** | **대시보드 (P1)** | **원형 녹색 버튼으로 강조** |
| 예약 | Calendar | 예약 | 예약 | `[TBD: 기획 미확정]` |
| 나 | User | 나 | 프로필 | `[TBD: 기획 미확정]` |

**동작 규칙:**
- 활성 탭: 녹색 아이콘 (#16a34a) + 하단 점 인디케이터 (animated)
- 비활성 탭: 회색 아이콘 (#9ca3af)
- "만들기" 탭: 항상 원형 녹색 배경에 흰색 + 아이콘
- 에디터(P5)와 새 프로젝트 플로우(P2~P4)에서는 네비게이션 숨김

### 3.3 토스트 알림

모든 화면에서 사용되는 인앱 알림입니다.

| 타입 | 배경색 | 사용 예시 |
|------|--------|----------|
| `info` | 회색 (gray-800) | "먼저 비디오 클립을 추가해주세요" |
| `warning` | 주황 (amber-600) | "텍스트/스티커 클립은 분할할 수 없습니다" |
| `error` | 빨강 (red-600) | "업로드에 실패했습니다" |
| `success` | 초록 (emerald-600) | "공유가 완료되었습니다" |

**동작 규칙:**
- 화면 하단에서 슬라이드업 등장 → 2.5초 후 자동 사라짐
- 새 토스트 발생 시 기존 토스트 즉시 교체
- 위치: 하단 네비게이션 바 위 (bottom: 96px)

### 3.4 다크/라이트 모드

| 항목 | 규칙 |
|------|------|
| 기본값 | 시스템 설정 따름 (`prefers-color-scheme`) |
| 전환 | 대시보드 헤더의 토글 버튼 |
| 저장 | `localStorage` 또는 사용자 DB 설정 |
| 적용 범위 | 대시보드, 에디터 영역 (편집 패널은 고정 다크 테마) |

### 3.5 데이터 영속성

> 프로토타입은 로컬 메모리만 사용합니다 (새로고침 시 초기화).
> 실 서비스에서는 아래 영속성 전략이 필요합니다.

| 데이터 | 저장소 | 시점 |
|--------|--------|------|
| 사용자 정보 | 서버 DB | 회원가입/로그인 |
| 프로젝트 목록 | 서버 DB | 생성/수정/삭제 시 |
| 프로젝트 타임라인 | 서버 DB | 자동 저장 (변경 후 2초 디바운스) |
| 업로드 미디어 | 오브젝트 스토리지 (S3) | 업로드 완료 시 |
| 내보내기 결과물 | 오브젝트 스토리지 (S3) | 렌더링 완료 시 |
| 테마 설정 | localStorage + 서버 | 토글 시 |

### 3.6 로딩 상태 처리

모든 네트워크 요청에 대해 아래 3가지 상태를 처리해야 합니다.

| 상태 | UI 처리 |
|------|---------|
| **로딩 중** | 해당 영역에 스켈레톤 UI 또는 스피너 표시, 버튼 비활성화 |
| **성공** | 데이터 표시, 성공 토스트 (필요시) |
| **실패** | 에러 토스트 + 재시도 버튼 또는 안내 메시지 |

---

## P1. 대시보드

> [스크린샷: 대시보드 전체 화면]

### 개요

| 항목 | 내용 |
|------|------|
| 목적 | 사용자의 프로젝트를 관리하고, 새 프로젝트를 생성하는 진입점 |
| 진입 경로 | 하단 네비게이션 "만들기" 탭 |
| 하단 네비게이션 | 표시 |

### 화면 구성

```
┌────────────────────────────────────┐
│ ← 만들기                    🌙/☀️  │  A. 헤더
├────────────────────────────────────┤
│ 👤 사용자명                        │  B. 프로필 영역
│    한줄 소개                       │
├────────────────────────────────────┤
│ 공유하기                           │  C. 공유 섹션
│ [📷 촬영하기] [📤 영상 업로드]       │
├────────────────────────────────────┤
│ 빠른 시작                          │  D. 빠른 시작
│ [+ 새 프로젝트] [📋 최근 복제]      │
├────────────────────────────────────┤
│ 추천 템플릿                        │  E. 템플릿 가로 스크롤
├────────────────────────────────────┤
│ 내 프로젝트                        │  F. 프로젝트 목록
│ [카드1] [카드2] [카드3] ...        │
├────────────────────────────────────┤
│  홈  탐색  (+)만들기  예약  나      │  하단 네비게이션
└────────────────────────────────────┘
```

### A. 헤더

| 요소 | 동작 | 조건 |
|------|------|------|
| ← 뒤로가기 | 홈 탭으로 전환 | 항상 활성 |
| 페이지 제목 | "만들기" 고정 텍스트 | - |
| 🌙/☀️ 다크모드 토글 | 테마 전환 | 항상 활성 |

### B. 프로필 영역

| 요소 | 데이터 소스 |
|------|-----------|
| 프로필 이미지 | 사용자 프로필 사진 (없으면 기본 아바타 아이콘) |
| 사용자명 | `user.displayName` |
| 한줄 소개 | `user.bio` (예: "100클이 골퍼") |

### C. 공유 섹션

#### C-1. 촬영하기 버튼

> [스크린샷: 촬영하기 버튼]

| 항목 | 상세 |
|------|------|
| 디자인 | 녹색 그라데이션 배경, 좌측 원형 카메라 아이콘 |
| 탭 동작 | 기기 카메라 앱 연동 `[TBD: 네이티브 카메라 API or WebRTC]` |
| 결과물 | 촬영 완료 → 영상 파일을 미디어 선택 화면으로 전달 |
| 미지원 시 | "카메라를 사용할 수 없습니다" 토스트 (error) |

#### C-2. 영상 업로드 버튼

| 항목 | 상세 |
|------|------|
| 디자인 | 흰색 배경, 회색 보더, 좌측 원형 업로드 아이콘 |
| 탭 동작 | **공유 모드**로 미디어 선택 화면(P3) 이동 |
| 공유 모드 | 비율 선택(P2) 건너뜀, 기본 비율 9:16 |

### D. 빠른 시작

2열 그리드. 각 카드는 점선 테두리의 대시형 버튼입니다.

#### D-1. 새 프로젝트 시작

| 항목 | 상세 |
|------|------|
| 아이콘 | 녹색 원형 배경 + Plus 아이콘 |
| 탭 동작 | 비율 선택 화면(P2)으로 이동 |
| 조건 | 항상 활성 |

#### D-2. 최근 프로젝트 복제

| 항목 | 상세 |
|------|------|
| 아이콘 | 파란색 원형 배경 + Copy 아이콘 |
| 탭 동작 | 가장 최근 `updatedAt` 프로젝트를 복제 |
| 복제 로직 | 프로젝트의 모든 데이터 딥카피, 이름에 " (복사)" 접미사, `createdAt`/`updatedAt` = 현재 시각, 새 ID 생성 |
| 비활성 조건 | 프로젝트가 0개일 때 → 50% 투명도, 탭 불가 |
| 완료 피드백 | 프로젝트 목록에 즉시 반영 (낙관적 업데이트) |

### E. 추천 템플릿

> [스크린샷: 추천 템플릿 가로 스크롤]

가로 스크롤 가능한 카드 목록입니다.

| 템플릿 | 비율 | 설명 | 태그 | 자동 생성 클립 |
|--------|------|------|------|-------------|
| 하이라이트 릴 | 9:16 | 베스트 샷 모음 | 인기 | 텍스트("My Best Shots") + BGM(Energetic Beat) |
| 연습 기록 | 16:9 | 연습 영상 기록 | 추천 | 텍스트(날짜) + 필터(Soft) |
| SNS 쇼츠 | 9:16 | 짧은 클립 | 트렌드 | BGM(Trendy Pop) + 스티커(불꽃) |
| 분석 영상 | 16:9 | 데이터 분석 | 프로 | 텍스트(데이터) + 필터(Pro) |

**탭 동작:**
1. 선택한 템플릿 정보를 저장
2. 비율 선택 화면(P2)으로 이동
3. P2에서 해당 비율이 **사전 선택**된 상태로 표시
4. 프로젝트 생성 시 템플릿의 자동 생성 클립이 타임라인에 추가

### F. 프로젝트 목록

> [스크린샷: 프로젝트 목록 - 데이터 있음]
> [스크린샷: 프로젝트 목록 - 빈 상태]

2열 그리드 형태입니다.

#### 프로젝트 카드 구성

| 영역 | 내용 | 조건 |
|------|------|------|
| 썸네일 | 프로젝트 대표 이미지 (aspect-ratio: 16/9) | 없으면 회색 배경 + Plus 아이콘 |
| 영상 길이 뱃지 | "M:SS" 형식 (우측 하단, 반투명 검정 배경) | `duration > 0`일 때만 표시 |
| 프로젝트명 | 최대 1줄, 넘치면 말줄임(...) | - |
| 수정 시각 | "방금 전", "N시간 전", "어제", "N일 전" | `updatedAt` 기준 상대 시간 |
| ⋮ 더보기 버튼 | 바텀시트 열기 | 항상 표시 |

**시간 표시 규칙:**

| 경과 시간 | 표시 |
|-----------|------|
| 1시간 미만 | "방금 전" |
| 1~23시간 | "N시간 전" |
| 24~47시간 | "어제" |
| 48시간 이상 | "N일 전" |

**정렬:** `updatedAt` 내림차순 (최신 수정순)

#### 프로젝트 카드 탭 동작

- 썸네일 영역 탭 → 해당 프로젝트로 에디터(P5) 진입
  - 서버에서 프로젝트 데이터 로딩
  - 로딩 중: 프로젝트 카드에 스피너 오버레이

#### 빈 상태 (프로젝트 0개)

| 요소 | 내용 |
|------|------|
| 아이콘 | Film 아이콘 (회색, 원형 배경) |
| 메인 텍스트 | "아직 프로젝트가 없습니다" |
| 서브 텍스트 | "위의 '새 프로젝트 시작'을 눌러 시작하세요" |

#### 바텀시트 (프로젝트 ⋮ 메뉴)

> [스크린샷: 바텀시트]

| 메뉴 | 동작 | 확인 단계 |
|------|------|----------|
| 복제 | 프로젝트 딥카피 (D-2와 동일 로직) | 즉시 실행 |
| 이름 변경 | 텍스트 입력 다이얼로그 표시 | 확인 버튼 클릭 시 실행 |
| 삭제 | 프로젝트 삭제 | `[TBD: 확인 다이얼로그 추가 권장]` |

**이름 변경 다이얼로그:**

| 항목 | 상세 |
|------|------|
| 입력 필드 | 기존 이름이 미리 입력된 텍스트 필드, autofocus |
| 유효성 | 빈 문자열 불가 (확인 버튼 비활성), 앞뒤 공백 자동 제거(trim) |
| 최대 길이 | `[TBD: 예상 50자]` |
| 취소 버튼 | 변경 없이 다이얼로그 닫기 |
| 확인 버튼 | 이름 변경 API 호출 → 목록 갱신 |

---

## P2. 비율 선택

> [스크린샷: 비율 선택 화면]

### 개요

| 항목 | 내용 |
|------|------|
| 목적 | 새 프로젝트의 화면 비율(종횡비) 선택 |
| 진입 경로 | 대시보드 → "새 프로젝트 시작" 또는 템플릿 선택 |
| 하단 네비게이션 | 숨김 |

### 화면 구성

```
┌────────────────────────────────────┐
│ 화면 비율 선택                   ✕ │  헤더
├────────────────────────────────────┤
│ 프로젝트에 사용할 화면 비율을        │  안내 텍스트
│ 선택하세요                         │
│                                    │
│ ┌──────────────────────────────┐  │
│ │ [16:9 아이콘]  16:9          │  │  비율 카드 A
│ │               유튜브 등 가로  │  │
│ └──────────────────────────────┘  │
│ ┌──────────────────────────────┐  │
│ │ [9:16 아이콘]  9:16          │  │  비율 카드 B
│ │               쇼츠, 릴스 세로 │  │
│ └──────────────────────────────┘  │
│ ┌──────────────────────────────┐  │
│ │ [1:1 아이콘]   1:1           │  │  비율 카드 C
│ │               인스타 피드     │  │
│ └──────────────────────────────┘  │
├────────────────────────────────────┤
│           [ 다음 ]                 │  하단 고정 버튼
└────────────────────────────────────┘
```

### 비율 옵션

| 비율 | 라벨 | 설명 | 실제 해상도 예시 |
|------|------|------|---------------|
| 16:9 | 16:9 | 유튜브 등 가로 영상 | 1920x1080, 1280x720 |
| 9:16 | 9:16 | 쇼츠, 릴스 등 세로 영상 | 1080x1920, 720x1280 |
| 1:1 | 1:1 | 인스타그램 피드 | 1080x1080, 720x720 |

### 인터랙션 규칙

| 요소 | 동작 | 조건 |
|------|------|------|
| ✕ 닫기 | 대시보드(P1)로 복귀 | 항상 |
| 비율 카드 탭 | 해당 비율 선택 | 단일 선택 (라디오) |
| 다음 버튼 | 미디어 선택(P3)으로 이동 | **비율이 선택되었을 때만 활성** |

**선택 상태 시각 피드백:**
- 미선택 카드: 회색 테두리 (#e5e7eb), 흰색 배경
- 선택된 카드: 파란색 테두리 (#3b82f6), 파란 배경 (blue-50), 우측에 파란 원형 체크 아이콘

**템플릿에서 진입 시:**
- `initialAspectRatio` 파라미터로 해당 비율이 사전 선택된 상태
- 사용자가 다른 비율로 변경 가능

**프로젝트 생성 후 비율 변경:**
- 불가. 비율은 프로젝트 생성 시 확정되며 이후 변경할 수 없음
- `[TBD: 비율 변경 기능이 필요하면 에디터 설정에 추가]`

---

## P3. 미디어 선택

> [스크린샷: 미디어 선택 화면 - 선택 전]
> [스크린샷: 미디어 선택 화면 - 선택 후]

### 개요

| 항목 | 내용 |
|------|------|
| 목적 | 프로젝트에 사용할 미디어(영상/이미지) 선택 |
| 진입 경로 | 비율 선택(P2) → "다음" 또는 대시보드 "영상 업로드" (공유 모드) |
| 하단 네비게이션 | 숨김 |
| 데이터 소스 | 사용자가 업로드한 미디어 목록 (서버 API) |

### 화면 구성

```
┌────────────────────────────────────┐
│ ← 미디어 선택                    ✕ │  헤더
│ [전체] [영상] [이미지]              │  필터 탭
├────────────────────────────────────┤
│ 1월 30일 (목) 2개                  │  날짜 헤더 (sticky)
│ ┌──────┬──────┬──────┐           │
│ │ 🟢   │      │      │           │  미디어 그리드 (3열)
│ │ 0:15 │      │ ①✓   │           │
│ └──────┴──────┴──────┘           │
│ 1월 29일 (수) 2개                  │  날짜 헤더
│ ┌──────┬──────┬──────┐           │
│ │ 🟢   │ 🟢   │      │           │
│ └──────┴──────┴──────┘           │
├────────────────────────────────────┤
│ 🟢 스윙 분석 데이터 포함           │  범례
├────────────────────────────────────┤
│ 3개 선택됨          화면 비율: 9:16 │  선택 정보
│          [ 타임라인 생성 ]          │  하단 고정 버튼
└────────────────────────────────────┘
```

### 미디어 목록 조회

**API 요청:** `GET /api/media?userId={userId}&sort=createdAt:desc`

**필터 탭:**

| 탭 | 필터 조건 |
|----|----------|
| 전체 | 타입 무관 |
| 영상 | `type = 'video'` |
| 이미지 | `type = 'image'` |

**날짜 그룹화 규칙:**
- `createdAt` 기준 날짜별 내림차순 그룹화
- 그룹 헤더: "오늘", "어제", 또는 "M월 D일 (요일)"
- 그룹 헤더에 해당 날짜의 미디어 수 표시
- 그룹 헤더는 스크롤 시 sticky (상단 고정)

### 미디어 아이템 표시

3열 그리드, 정사각형 썸네일 (aspect-ratio: 1/1), 간격 0.5px.

| 정보 | 위치 | 조건 | 디자인 |
|------|------|------|--------|
| 썸네일 이미지 | 전체 | 항상 | `object-fit: cover` |
| 메타데이터 마크 | 좌측 하단 | `hasMetadata = true` | 녹색(#16a34a) 원형 배경 + Info 아이콘 |
| 영상 길이 | 우측 하단 | `type = 'video'` | 반투명 검정 배경 + Play 아이콘 + "M:SS" |
| 선택 순서 번호 | 우측 상단 | 선택 시 | 파란색 원형 + 흰색 번호 |
| 선택 체크 | 좌측 상단 | 선택 시 | 파란색 원형 + 체크 아이콘 |
| 선택 오버레이 | 전체 | 선택 시 | 파란색 30% 반투명 + 파란 테두리 2px |

**메타데이터 마크 의미:**
- 스크린골프 시뮬레이터에서 기록된 샷 분석 데이터(클럽 종류, 스윙 스피드, 위치 등)가 포함된 미디어
- 이 마크가 있는 미디어로 프로젝트를 생성하면 에디터에서 AI 어시스턴트 기능 사용 가능

### 미디어 선택 규칙

| 규칙 | 상세 |
|------|------|
| 선택 방식 | 탭하여 토글 (선택/해제) |
| 다중 선택 | 가능, 순서 유지 (선택한 순서가 타임라인 배치 순서) |
| 최소 선택 | 1개 이상 선택해야 "다음/타임라인 생성" 버튼 활성화 |
| 최대 선택 | `[TBD: 예상 20개]` 초과 시 토스트 경고 |
| 선택 순서 | 우측 상단 번호로 표시 (1, 2, 3...) |
| 해제 시 | 번호 재정렬 (예: 2번 해제 → 3번이 2번으로) |

### 하단 영역

| 요소 | 내용 |
|------|------|
| 범례 | 녹색 원 + "스윙 분석 데이터 포함" 설명 |
| 선택 카운트 | "N개 선택됨" (0이면 "미디어를 선택하세요") |
| 비율 표시 | "화면 비율: {aspectRatio}" |
| 액션 버튼 | 편집 모드: "타임라인 생성", 공유 모드: "다음" |
| 버튼 비활성 | 선택 0개일 때 40% 투명도, 탭 불가 |

### 두 가지 진입 모드

| 항목 | 편집 모드 (기본) | 공유 모드 |
|------|----------------|----------|
| 진입 | 대시보드 → 새 프로젝트 | 대시보드 → 영상 업로드 |
| 비율 선택 | P2에서 선택 | 건너뜀 (기본 9:16) |
| ← 뒤로가기 | P2 비율 선택으로 | 대시보드로 |
| 하단 버튼 | "타임라인 생성" → P4 AI 처리 | "다음" → 공유 다이얼로그 |
| 2개+ 선택 시 | 바로 P4로 이동 | **"편집 모드 전환" 확인 다이얼로그** |

**편집 모드 전환 다이얼로그 (공유 모드에서 2개+ 선택 시):**

| 요소 | 내용 |
|------|------|
| 제목 | "편집 모드로 전환" |
| 본문 | "여러 개의 미디어를 선택하셨습니다. 편집 모드로 전환하시겠습니까?" |
| 취소 | 다이얼로그만 닫기 (미디어 선택 화면 유지) |
| 편집하기 | P4 AI 처리 → P5 에디터로 이동 |

---

## P4. AI 처리

> [스크린샷: AI 처리 화면 - 진행 중]

### 개요

| 항목 | 내용 |
|------|------|
| 목적 | 선택한 미디어를 분석하고 초기 타임라인을 자동 생성 |
| 진입 경로 | 미디어 선택(P3) → "타임라인 생성" |
| 하단 네비게이션 | 숨김 |
| 사용자 개입 | 불가 (자동 진행, 취소/뒤로가기 없음) |

### 처리 단계

> 프로토타입은 고정 타이밍 시뮬레이션입니다.
> 실 서비스에서는 서버 API 폴링 또는 WebSocket으로 실제 진행률을 받아야 합니다.

| 단계 | 메시지 | 아이콘 | 서버 처리 내용 |
|------|--------|--------|-------------|
| 1 | "미디어 분석 중..." | Loader (회전) | 영상 메타데이터 추출, 썸네일 생성, 코덱/해상도 확인 |
| 2 | "타임라인 생성 중..." | Loader (회전) | 미디어 순서대로 비디오 클립 배치, 총 길이 계산 |
| 3 | "자동 자막 생성 중..." | Type 아이콘 | `[TBD: STT 자막 자동 생성 여부]` |
| 4 | "추천 스티커 배치 중..." | Sticker 아이콘 | `[TBD: AI 자동 스티커 추천 여부]` |
| 5 | "완료!" | Sparkles 아이콘 | - |

### 화면 구성

| 요소 | 상세 |
|------|------|
| 중앙 아이콘 | 단계별 변경, scale 0.8→1 + opacity 0→1 애니메이션 |
| 진행 메시지 | 단계별 변경, 페이드 전환 |
| 상세 텍스트 | "N개의 미디어로 {비율} 프로젝트를 생성하고 있습니다" |
| 프로그레스 바 | 0% → 20% → 50% → 75% → 95% → 100% (ease-out) |
| 체크리스트 | 4개 항목, 진행 완료 시 녹색 체크로 변경 (scale 0→1 애니메이션) |

### 완료 시 동작

1. 100% 도달 후 0.8초 대기
2. 서버에서 생성된 프로젝트 데이터를 받아 상태에 저장
3. 에디터(P5)로 자동 전환

### 프로젝트 생성 시 서버 처리

| 처리 | 상세 |
|------|------|
| 비디오 클립 생성 | 선택한 미디어 순서대로 `position=0, 이전클립끝` 으로 배치 |
| shotData 매핑 | `hasMetadata=true`인 미디어의 metadata → 해당 VideoClip의 shotData로 변환 |
| 썸네일 설정 | 첫 번째 미디어의 썸네일 → 프로젝트 대표 썸네일 |
| 총 길이 계산 | 모든 비디오 클립의 `position + duration` 합산 |
| 템플릿 클립 | 템플릿 선택 시, 템플릿 정의에 따른 텍스트/오디오/필터/스티커 클립 자동 생성 |

### 에러 처리

| 에러 | 처리 |
|------|------|
| 미디어 분석 실패 | "미디어를 분석할 수 없습니다" 에러 토스트 → 미디어 선택(P3)으로 복귀 |
| 네트워크 오류 | "네트워크 연결을 확인해주세요" 에러 토스트 + 재시도 버튼 |
| 서버 타임아웃 | 30초 경과 시 "처리 시간이 초과되었습니다" → 재시도 버튼 |

---

## P5. 영상 에디터

> [스크린샷: 에디터 전체 화면]

### 개요

| 항목 | 내용 |
|------|------|
| 목적 | 타임라인 기반 영상 편집 (핵심 기능) |
| 진입 경로 | P4 완료 후 자동 이동 또는 대시보드에서 프로젝트 클릭 |
| 하단 네비게이션 | 숨김 (전용 편집 툴바 사용) |

### 화면 영역

```
┌────────────────────────────────────┐
│ A. 상단 바                         │  높이 약 56px
├────────────────────────────────────┤
│ B. 미리보기 영역                    │  높이 45%
├────────────────────────────────────┤
│ C. 타임라인 컨트롤                  │  높이 약 36px
├────────────────────────────────────┤
│ D. 타임라인 (5개 트랙)              │  나머지 높이
├────────────────────────────────────┤
│ E. 하단 편집 툴바                   │  높이 약 60px
└────────────────────────────────────┘
```

---

### A. 상단 바

> [스크린샷: 에디터 상단 바]

| 요소 | 동작 | 조건 |
|------|------|------|
| ← 뒤로가기 | 프로젝트를 서버에 저장 → 대시보드(P1) 복귀 | 항상 |
| 프로젝트명 | 탭 → 인라인 편집 모드 (input으로 변환) | 항상 |
| 저장 상태 | 자동 표시 | 아래 규칙 참조 |
| Undo 버튼 | 마지막 작업 되돌리기 | `canUndo = true`일 때 활성 |
| Redo 버튼 | 되돌린 작업 재실행 | `canRedo = true`일 때 활성 |
| [만들기] 버튼 | 내보내기 패널(P6) 열기 | 항상 활성 |

**프로젝트명 인라인 편집:**
- 탭 시 `<input>` 으로 변환, autofocus
- Enter 키 또는 포커스 해제(blur) → 편집 완료, 서버 저장
- 유효성: 빈 문자열 불가, trim 적용
- 최대 길이: `[TBD: 예상 50자]`

**자동 저장 상태:**

| 상태 | 아이콘 | 텍스트 | 트리거 |
|------|--------|--------|--------|
| 저장됨 | 회색 체크 | "저장됨" | 저장 완료 시 |
| 저장 중 | 녹색 스피너 | "저장 중..." | 타임라인 변경 후 2초 디바운스 경과 |
| 미저장 | 주황 원 | "저장되지 않음" | 타임라인 변경 직후 |

**Undo/Redo:**
- 최대 30단계 히스토리
- 키보드: `Ctrl+Z` (Undo), `Ctrl+Y` 또는 `Ctrl+Shift+Z` (Redo)
- 비활성 시 30% 투명도

---

### B. 미리보기 영역

> [스크린샷: 미리보기 - 필터 적용 상태]
> [스크린샷: 미리보기 - 텍스트/스티커 오버레이]

| 기능 | 상세 |
|------|------|
| 비율 자동 조정 | 프로젝트 비율에 맞는 `aspect-ratio` 적용 |
| 비율 뱃지 | 우측 상단 "16:9"/"9:16"/"1:1" 표시 |
| 영상 재생 | `[TBD: HTML5 video + HLS or 직접 재생]` |
| 재생 컨트롤 | 호버/탭 시 반투명 검정 오버레이에 Play/Pause 버튼 |
| 시간 표시 | 좌측 하단 "현재시간 / 총시간" (MM:SS 형식) |
| 전체화면 | 우측 하단 확대 아이콘 `[TBD: 전체화면 구현 방식]` |

**필터 실시간 미리보기:**

현재 플레이헤드 시간에 활성화된 필터 클립이 있으면, 미리보기 영상에 CSS `filter` 속성을 적용합니다.

| 필터 프리셋 | CSS filter 값 |
|------------|--------------|
| vivid | `brightness(1.1) contrast(1.2) saturate(1.4)` |
| soft | `brightness(1.05) contrast(0.9) saturate(0.85)` |
| cool | `hue-rotate(-15deg) saturate(1.1) brightness(0.95)` |
| warm | `sepia(0.15) saturate(1.3) brightness(1.05)` |
| pro | `contrast(1.15) saturate(1.1)` |
| 커스텀 | `brightness({1+b/100}) contrast({1+c/100}) saturate({1+s/100}) hue-rotate({t*0.5}deg)` |

- 프리셋과 커스텀 슬라이더를 모두 설정한 경우: 커스텀 값이 0이 아니면 커스텀 우선
- 활성 필터가 있으면 좌측 상단에 보라색 뱃지로 필터명 표시
- `transition: filter 300ms` 로 부드러운 전환

**텍스트/스티커 오버레이:**

현재 시간에 활성화된 텍스트/스티커 클립을 미리보기 위에 렌더링합니다.

| 속성 | 상세 |
|------|------|
| 위치 | 클립의 `textPosition` / `stickerPosition` ({x: 0~100, y: 0~100} 퍼센트 좌표) |
| 드래그 | 미리보기 영역 내에서 드래그하여 위치 변경 가능 |
| 선택 표시 | 선택된 클립은 테두리 표시 |
| 표시 조건 | `currentTime >= clip.position && currentTime < clip.position + clip.duration` |

---

### C. 타임라인 컨트롤

| 요소 | 상세 |
|------|------|
| "타임라인" 라벨 | 고정 텍스트 |
| AI 버튼 ✨ | 아래 AI 어시스턴트 섹션 참조 |
| 줌 (-) 버튼 | `zoom = max(0.5, zoom - 0.25)` |
| 줌 레벨 표시 | "Nx" 형식 (예: "1x") |
| 줌 (+) 버튼 | `zoom = min(3.0, zoom + 0.25)` |

**AI 버튼 활성화 조건:**
- 프로젝트의 `clips` 배열에서 `shotData`가 존재하는 클립이 **1개 이상** → 녹색 활성 상태
- `shotData`가 없으면 → 회색 비활성 (탭 불가, 커서 not-allowed)
- 활성 시 탭 → AI 어시스턴트 패널 열기

---

### D. 타임라인

> [스크린샷: 타임라인 - 5개 트랙]

#### 전체 구조

```
┌──────┬────────────────────────────────────────┐
│ 레이블 │              클립 영역                  │
│ (64px)│         (가로 스크롤 가능)               │
│ sticky│                                        │
├──────┼────────────────────────────────────────┤
│ 영상  │ [클립1]──[클립2]◇[클립3]                │ h=64px
├──────┼────────────────────────────────────────┤
│텍스트 │ [텍스트A]                               │ h=48px
├──────┼────────────────────────────────────────┤
│오디오 │ [BGM~~~~~~~~~~~]                       │ h=48px
├──────┼────────────────────────────────────────┤
│ 필터  │     [필터X]                             │ h=48px
├──────┼────────────────────────────────────────┤
│스티커 │ [🏌️]                                    │ h=48px
└──────┴────────────────────────────────────────┘
              │ ← 중앙 고정 플레이헤드 (빨간 세로선)
```

#### 5개 트랙

| 트랙 | 식별색 | 높이 | 레이블 탭 동작 | 더블탭 동작 |
|------|--------|------|-------------|----------|
| 영상 (video) | #3b82f6 파란색 | 64px | 없음 | 없음 |
| 텍스트 (text) | #f59e0b 주황색 | 48px | 텍스트 추가 패널 열기 | 해당 클립 수정 패널 열기 |
| 오디오 (audio) | #10b981 초록색 | 48px | 오디오 추가 패널 열기 | 해당 클립 수정 패널 열기 |
| 필터 (filter) | #a855f7 보라색 | 48px | 필터 추가 패널 열기 | 해당 클립 수정 패널 열기 |
| 스티커 (sticker) | #ec4899 핑크색 | 48px | 스티커 추가 패널 열기 | 해당 클립 수정 패널 열기 |

#### 중앙 고정 플레이헤드

- 빨간색 세로선, 화면 **정중앙에 고정**
- 상단에 빨간 원형 핸들 (직경 12px)
- 타임라인 전체를 좌우로 스크롤하면 플레이헤드 아래의 시간이 변경됨
- `currentTime = (scrollLeft + containerWidth/2 - leftPadding - labelWidth) / (pixelsPerSecond * zoom)`

#### 타임 눈금자

- 트랙 상단에 고정 (sticky top)
- 5초 간격으로 눈금선 + "Ns" 라벨 표시
- 줌 레벨에 따라 간격 자동 조정

#### 클립 표시 규칙

| 속성 | 계산 |
|------|------|
| 수평 위치 (px) | `clip.position * pixelsPerSecond * zoom + leftPadding` |
| 너비 (px) | `clip.duration * pixelsPerSecond * zoom` |
| 배경색 | 트랙별 식별색 |
| 최소 너비 | 20px (너무 짧은 클립도 탭 가능하도록) |

#### 빈 트랙 힌트

클립이 없는 트랙에 회색 힌트 텍스트 표시:
- 레이블 클릭 가능한 트랙: "+ {트랙명} 추가" (예: "+ 텍스트 추가")
- 레이블 클릭 불가 트랙: "{트랙명} 없음" (예: "영상 없음")

#### 클립 조작 매트릭스

| 조작 | 영상 | 텍스트 | 오디오 | 필터 | 스티커 |
|------|------|--------|--------|------|--------|
| 탭 → 선택 | O | O | O | O | O |
| 롱프레스 → 드래그 이동 | O (순서 교환) | O (자유 위치) | O (자유 위치) | O (자유 위치) | O (자유 위치) |
| 분할 | O | X | O | O | X |
| 속도 변경 | O (0.1x~8x) | X | X | X | X |
| 원본 볼륨 | O (0~100%) | X | X | X | X |
| 수정 (편집 패널) | X | O | O | O | O |
| 복제 | O | O | O | O | O |
| 삭제 | O | O | O | O | O |
| 좌우 트림 | O | O | O | O | O |
| 전환 효과 | O | X | X | X | X |

#### 분할 규칙

1. 분할할 클립이 선택된 상태여야 함
2. 플레이헤드가 해당 클립 위에 위치해야 함 (아니면 토스트 경고)
3. 분할 결과 양쪽 클립 모두 **최소 0.5초** 이상이어야 함 (아니면 토스트 경고)
4. 텍스트/스티커 클립은 분할 불가 (토스트 경고)
5. 분할 시 원본 클립의 `startTime`/`endTime` 구간이 보존됨

#### 트림 규칙

| 트랙 | 좌측 핸들 | 우측 핸들 | 제약 |
|------|----------|----------|------|
| 영상 | 시작점 조정 (position + duration 연동) | 끝점 조정 | 원본 `startTime`~`endTime` 범위 내 |
| 텍스트/오디오/필터/스티커 | 위치 + 길이 동시 조정 | 길이만 조정 | 영상 트랙 총 길이를 초과 불가 |

- 최소 클립 길이: 0.5초
- 트림 시 리플 편집 적용 (후속 클립 자동 이동)

#### 리플 편집

```
변경 전: [A: 0~5s] [B: 5~10s] [C: 10~15s]

A의 길이를 7초로 확장:
변경 후: [A: 0~7s  ] [B: 7~12s] [C: 12~17s]
                      ↑ 후속 클립이 자동으로 밀림
```

- 영상 트랙: 항상 리플 편집 적용 (클립 간 빈틈 없음)
- 비영상 트랙: 자유 배치 (리플 편집 미적용), 단 영상 트랙 범위 초과 불가

#### 클립 이동 (드래그)

1. 클립을 500ms 이상 롱프레스 → 드래그 모드 활성화
2. 드래그 시 다른 클립의 시작/끝 지점에 **스냅**
   - 스냅 임계값: 0.3초
   - 스냅 시: 녹색 가이드라인 표시 + 햅틱 피드백 (`navigator.vibrate(10)`)
3. 손 떼면 새 위치에 배치

**영상 트랙 이동 특수 규칙:**
- 영상 클립은 자유 이동이 아닌 **순서 교환** 방식
- 드래그한 클립이 다른 클립의 중간을 넘으면 순서 교환

#### 클립 오버랩 표시

같은 트랙에서 두 클립의 시간 범위가 겹치면:
- 겹치는 클립 모두에 **점선 테두리** 적용
- 50% 투명도 적용
- 실시간 감지 (매 렌더링마다 계산)

#### 전환 효과 (영상 트랙 전용)

> [스크린샷: 전환 효과 아이콘]

인접한 영상 클립 사이(간격 0.5초 이내)에 다이아몬드(◇) 아이콘을 표시합니다.

| 전환 타입 | 아이콘 | 설명 | 실 구현 |
|----------|--------|------|---------|
| none | ◇ (회색) | 전환 없음 (기본값) | 하드컷 |
| fade | F (파란색) | 페이드 전환 | 크로스 디졸브 |
| slide | S (파란색) | 슬라이드 전환 | 좌→우 슬라이드 |
| zoom | Z (파란색) | 줌 전환 | 줌인/줌아웃 |

탭 시 하단에서 전환 선택 패널이 올라옵니다.

#### 핀치 줌

- 두 손가락 핀치로 타임라인 확대/축소
- 범위: 0.5x ~ 3.0x
- 줌 변경 시 현재 플레이헤드 위치 유지

---

### E. 하단 편집 툴바

> [스크린샷: 편집 툴바 - 클립 선택 상태]
> [스크린샷: 편집 툴바 - 다중 선택 모드]

#### 기본 모드

| 버튼 | 아이콘 | 표시 조건 | 활성 조건 | 동작 |
|------|--------|----------|----------|------|
| 다중선택 | CheckSquare | 항상 | 클립 1개 이상 선택 시 | 다중 선택 모드 진입 |
| 분할 | Scissors | 영상/오디오/필터 클립 선택 시 | 선택된 클립 있을 때 | 플레이헤드 위치에서 분할 |
| 속도 | Gauge | 영상 클립 선택 시만 | 선택된 클립 있을 때 | 속도 조절 패널 열기 |
| 볼륨 | Volume2 | 영상 클립 선택 시만 | 선택된 클립 있을 때 | 볼륨 패널 열기 |
| 수정 | Pencil | 텍스트/오디오/필터/스티커 선택 시 | 선택된 클립 있을 때 | 해당 편집 패널 열기 |
| 복제 | Copy | 항상 | 클립 1개 이상 선택 시 | 선택 클립 바로 뒤에 복사본 |
| 삭제 | Trash2 (빨강) | 항상 | 클립 1개 이상 선택 시 | 삭제 확인 다이얼로그 |

비활성 버튼: 40% 투명도, 탭 불가

#### 다중 선택 모드

다중선택 버튼 탭 시 진입:
- 클립 탭 → 선택/해제 토글 (체크박스 UI)
- 툴바: [선택 해제] [N개 선택됨] [일괄 삭제]
- 해제 조건: "선택 해제" 탭 또는 선택된 클립이 0개가 될 때

---

### 편집 패널 상세

모든 편집 패널은 **전체화면 오버레이**로 화면 하단에서 슬라이드업 등장합니다.

#### 텍스트 패널

> [스크린샷: 텍스트 패널]

| 설정 | 옵션 | 기본값 | 유효성 |
|------|------|--------|--------|
| 텍스트 내용 | 자유 입력 | "텍스트 입력" | 빈 문자열 불가, 최대 `[TBD: 200자]` |
| 폰트 | Noto Sans KR, Nanum Gothic, Nanum Myeongjo, Pretendard, 시스템 기본 | Noto Sans KR | - |
| 크기 | 16~96px 슬라이더 | 32px | 정수만 |
| 색상 | 12색 프리셋 (#FFFFFF, #000000, #FF0000 등) | #FFFFFF | - |
| 정렬 | 좌/중앙/우 | 중앙 | - |
| 스타일 | 굵게(B), 기울임(I), 밑줄(U) 토글 | 모두 OFF | 복합 선택 가능 |
| 애니메이션 | 11종 (아래 표) | fade-in | - |
| 클립 길이 | `[TBD: 기본 5초, 수정 가능]` | 5초 | 최소 0.5초 |
| 위치 | 미리보기에서 드래그 | 중앙 (50%, 50%) | 0~100% |

**텍스트 애니메이션 종류:**

| ID | 이름 | 효과 |
|----|------|------|
| none | 없음 | 정적 표시 |
| fade-in | 페이드 인 | 투명→불투명 |
| fade-out | 페이드 아웃 | 불투명→투명 |
| slide-up | 슬라이드 업 | 아래→위 이동 |
| slide-down | 슬라이드 다운 | 위→아래 이동 |
| slide-left | 슬라이드 좌 | 우→좌 이동 |
| slide-right | 슬라이드 우 | 좌→우 이동 |
| zoom-in | 줌 인 | 작은→큰 크기 |
| bounce | 바운스 | 탄성 효과 |
| typewriter | 타자기 | 한 글자씩 등장 |
| glow | 글로우 | 발광 효과 |

**새 텍스트 추가 시 배치 규칙:**
- 위치: 플레이헤드 현재 시간
- 영상 트랙에 클립이 없으면 추가 불가 → "먼저 비디오 클립을 추가해주세요" (info 토스트)
- 영상 트랙 총 길이를 초과하지 않도록 클립 길이 자동 조정

#### 오디오 패널

> [스크린샷: 오디오 패널]

| 설정 | 옵션 | 기본값 |
|------|------|--------|
| BGM 선택 | 카테고리별 목록 | 없음 |
| 볼륨 | 0~100 슬라이더 | 80 |
| 음소거 | 토글 | OFF |

**BGM 카테고리:**

| 카테고리 | 곡 목록 예시 |
|---------|-------------|
| 트렌디 | Trendy Pop, Urban Beat |
| 감성 | Emotional Piano, Gentle Acoustic |
| 에너지 | Energetic Beat, Power Rock |
| 어쿠스틱 | Morning Coffee, Sunset Stroll |

- BGM 선택 시 클립 기본 길이: 30초 (영상 범위 초과 시 자동 조정)
- BGM 미선택 시 기본 길이: 5초
- 오디오 트랙에 파형(waveform) 시각화 표시

#### 필터 패널

> [스크린샷: 필터 패널 - 프리셋 선택]
> [스크린샷: 필터 패널 - 커스텀 슬라이더]

| 설정 | 범위 | 기본값 |
|------|------|--------|
| 프리셋 | None, Vivid, Soft, Cool, Warm, Pro | None |
| 밝기 (Brightness) | -100 ~ +100 | 0 |
| 대비 (Contrast) | -100 ~ +100 | 0 |
| 채도 (Saturation) | -100 ~ +100 | 0 |
| 색온도 (Temperature) | -100 ~ +100 | 0 |

- 프리셋 선택 시 슬라이더는 초기화(0)됨
- 슬라이더 조정 시 프리셋은 유지되지만 커스텀 값이 우선 적용
- 미리보기에 실시간 CSS filter 반영
- 기본 클립 길이: 5초

#### 스티커 패널

> [스크린샷: 스티커 패널]

| 설정 | 옵션 | 기본값 |
|------|------|--------|
| 스티커 | 카테고리별 이모지/스포츠 스티커 | - |
| 애니메이션 | bounce, spin, pulse, shake, none | bounce |
| 크기 | 0.5x ~ 3x 슬라이더 | 1x |
| 위치 | 미리보기 드래그 | 중앙 (50%, 50%) |
| 클립 길이 | `[TBD: 기본 3초]` | 3초 |

#### 속도 패널

| 설정 | 범위 | 기본값 | 단위 |
|------|------|--------|------|
| 재생 속도 | 0.1x ~ 8x | 1x | 0.1 단위 |

- 속도 변경 시 클립 `duration`이 반비례로 변경
- 예: 10초 클립, 2x 속도 → 5초로 표시
- 후속 클립 리플 편집 적용

#### 볼륨 패널 (영상 원본 오디오)

| 설정 | 범위 | 기본값 |
|------|------|--------|
| 볼륨 | 0 ~ 100% 슬라이더 | 100% |
| 음소거 | 토글 | OFF |

---

### AI 어시스턴트 패널

> [스크린샷: AI 어시스턴트 패널]

| 항목 | 상세 |
|------|------|
| 활성화 조건 | 프로젝트 클립 중 `shotData` 보유 1개 이상 |
| 분석 트리거 | 패널 열릴 때 자동 분석 (메타데이터 기반) |
| 로딩 상태 | "메타데이터 분석 중..." 스피너 |

**분석 입력 데이터 (ShotData):**

| 필드 | 사용처 |
|------|--------|
| distance (비거리) | 거리 관련 텍스트/스티커 추천 |
| ballSpeed (볼스피드) | 스피드 관련 스티커 추천 |
| club (클럽) | 클럽 관련 텍스트 추천 |
| holeResult (결과) | 결과 관련 스티커/텍스트 (버디→버디스티커 등) |
| accuracy (정확도) | 정확도 관련 스티커 추천 |

**추천 결과:**

| 유형 | 예시 |
|------|------|
| 스티커 | 🏌️ 골프 스윙, 🔥 불꽃 (높은 스피드), 🎯 버디 |
| 텍스트 | "285yd Driver", "BIRDIE!", "Perfect Shot 🔥" |

**인터랙션:**
- 각 추천 항목: 탭으로 선택/해제 토글
- "전체 선택" / "전체 해제" 버튼
- "다시 분석" 버튼
- [추가] 버튼: 선택된 항목을 타임라인에 일괄 추가 (플레이헤드 위치에)
- 선택 카운트 실시간 표시

---

## P6. 내보내기

> [스크린샷: 내보내기 - 설정]
> [스크린샷: 내보내기 - 렌더링 중]
> [스크린샷: 내보내기 - 완료]

### 개요

| 항목 | 내용 |
|------|------|
| 목적 | 편집된 영상을 최종 파일로 렌더링하여 공유/다운로드 |
| 진입 경로 | 에디터 상단 "만들기" 버튼 |
| 표시 방식 | 모달 오버레이 (반투명 검정 배경) |

### 6.1 설정 단계

| 설정 | 옵션 | 기본값 |
|------|------|--------|
| 화질 | HD 720p (1280x720), **Full HD 1080p** (1920x1080), 4K UHD (3840x2160) | 1080p |
| 포맷 | **MP4** (호환성 최고), MOV (고품질 편집용) | MP4 |

- ✕ 닫기: 에디터로 복귀
- [만들기 시작] 버튼: 렌더링 단계로 진입

### 6.2 렌더링 단계

| 요소 | 상세 |
|------|------|
| 원형 프로그레스 | SVG 기반, 반지름 56px, 중앙에 퍼센트 표시 |
| 바 프로그레스 | 하단 보조 프로그레스 바 |
| 현재 작업 | 단계별 텍스트 (페이드 전환) |
| 취소 버튼 | 렌더링 중단 → 설정 단계로 복귀 |

**렌더링 단계:**

| 단계 | 메시지 | 서버 처리 |
|------|--------|----------|
| 1 | "프레임 처리 중" | 영상 디코딩, 크롭, 리사이즈 |
| 2 | "오디오 믹싱 중" | 원본 오디오 + BGM 믹싱 |
| 3 | "효과 렌더링 중" | 필터, 전환 효과, 텍스트/스티커 합성 |
| 4 | "최종 인코딩 중" | 선택한 화질/포맷으로 인코딩 |

**실 서비스 구현:**
- `[TBD: 서버사이드 FFmpeg 렌더링 → 진행률 WebSocket/SSE 전송]`
- `[TBD: 클라이언트 WebCodecs 사용 시 브라우저 호환성 확인 필요]`
- 취소 시 서버 작업 중단 API 호출

### 6.3 완료 단계

| 요소 | 상세 |
|------|------|
| 완료 아이콘 | 녹색 체크 (spring 애니메이션) |
| 파일 정보 | 파일명 (프로젝트명.포맷), 화질 |

### 완료 후 동선

| 버튼 | 동작 | 이후 화면 |
|------|------|----------|
| 🔗 공유 | 공유 다이얼로그 표시 (제목/내용 입력 → SNS 공유) | 공유 완료 → 대시보드 |
| 📥 다운로드 | 브라우저 파일 다운로드 트리거 | 다운로드 완료 확인 → 대시보드 |
| ✏️ 계속 편집 | 내보내기 모달 닫기 | 에디터 유지 |

**공유 다이얼로그:**
- 제목 입력 (기본값: 프로젝트명)
- 내용 입력 (선택)
- 공유 대상: `[TBD: SNS 연동 대상 - 카카오톡, 인스타그램, 링크 복사 등]`

---

## 화면 전환 흐름도

### 메인 플로우

```
[대시보드(P1)] ──새 프로젝트──▶ [비율 선택(P2)] ──다음──▶ [미디어 선택(P3)]
     │                                                        │
     │                                              타임라인 생성
     │                                                        ▼
     │                                               [AI 처리(P4)]
     │                                                        │
     │                                                   자동 전환
     │                                                        ▼
     └──기존 프로젝트 클릭──────────────────────▶ [에디터(P5)]
                                                              │
                                                         만들기 버튼
                                                              ▼
                                                       [내보내기(P6)]
                                                         │      │
                                                    공유/DL   계속편집
                                                         │      │
                                                    대시보드   에디터
```

### 공유 모드 플로우

```
대시보드 "영상 업로드" ──▶ 미디어 선택(P3) (비율 건너뜀, 기본 9:16)
                                 │
                        ┌────────┼────────┐
                        │                  │
                   1개 선택            2개 이상 선택
                        │                  │
                  공유 다이얼로그    "편집 모드 전환?" 다이얼로그
                        │              │           │
                   완료 → 닫기      편집하기      취소
                                       │           │
                                  P4 → P5     선택 유지
```

### 뒤로가기 동선

| 현재 화면 | ← 뒤로가기 | ✕ 닫기 |
|----------|-----------|--------|
| P1 대시보드 | 홈 탭 | - |
| P2 비율 선택 | - | 대시보드 |
| P3 미디어 선택 (편집) | P2 비율 선택 | 대시보드 |
| P3 미디어 선택 (공유) | 대시보드 | 대시보드 |
| P4 AI 처리 | 불가 (자동 진행) | 불가 |
| P5 에디터 | 저장 후 대시보드 | - |
| P6 내보내기 | - | 에디터 |

---

## 데이터 모델

### User (사용자)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| id | string (UUID) | O | 고유 ID |
| email | string | O | 이메일 |
| displayName | string | O | 표시 이름 |
| bio | string | X | 한줄 소개 |
| profileImage | string (URL) | X | 프로필 이미지 |
| createdAt | datetime | O | 가입일 |
| theme | 'light' \| 'dark' \| 'system' | O | 테마 설정 |

### Project (프로젝트)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| id | string (UUID) | O | 고유 ID |
| userId | string (UUID) | O | 소유자 ID |
| name | string | O | 프로젝트명 (최대 50자) |
| aspectRatio | '16:9' \| '9:16' \| '1:1' | O | 화면 비율 |
| duration | number | O | 총 길이 (초) |
| thumbnail | string (URL) | X | 대표 썸네일 |
| clips | VideoClip[] | O | 영상 클립 목록 |
| timeline | TimelineItem[] | O | 타임라인 아이템 목록 |
| templateId | string | X | 사용된 템플릿 ID |
| createdAt | datetime | O | 생성일 |
| updatedAt | datetime | O | 수정일 |

### VideoClip (영상 클립)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| id | string (UUID) | O | 고유 ID |
| mediaId | string | O | 연결된 미디어 ID |
| duration | number | O | 길이 (초) |
| thumbnail | string (URL) | X | 클립 썸네일 |
| shotData | ShotData | X | 스윙 분석 데이터 |

### ShotData (샷 분석 데이터)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| distance | number | O | 비거리 (yards) |
| ballSpeed | number | O | 볼 스피드 (mph) |
| clubSpeed | number | X | 클럽 스피드 (mph) |
| launchAngle | number | X | 발사각 (degrees) |
| backSpin | number | X | 백스핀 (rpm) |
| sideSpin | number | X | 사이드스핀 (rpm) |
| accuracy | number | O | 정확도 (0~100%) |
| club | ClubType | O | 클럽 종류 |
| holeResult | HoleResult | X | 홀 결과 |

**ClubType:** `'Driver' | '3Wood' | '5Wood' | '3Iron' | ... | 'PW' | 'SW' | 'Putter'`
**HoleResult:** `'hole-in-one' | 'eagle' | 'birdie' | 'par' | 'bogey' | 'double-bogey'`

### MediaItem (미디어)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| id | string (UUID) | O | 고유 ID |
| userId | string (UUID) | O | 소유자 ID |
| type | 'video' \| 'image' | O | 미디어 타입 |
| uri | string (URL) | O | 원본 파일 URL |
| thumbnail | string (URL) | O | 썸네일 URL |
| duration | number | X | 영상 길이 (type=video) |
| width | number | O | 가로 해상도 |
| height | number | O | 세로 해상도 |
| fileSize | number | O | 파일 크기 (bytes) |
| mimeType | string | O | MIME 타입 |
| hasMetadata | boolean | O | 샷 분석 데이터 보유 여부 |
| metadata | object | X | 메타데이터 (클럽, 스윙스피드 등) |
| createdAt | datetime | O | 촬영/업로드 일시 |

### TimelineItem (타임라인 클립)

| 필드 | 타입 | 필수 | 설명 |
|------|------|------|------|
| id | string (UUID) | O | 고유 ID |
| clipId | string | O | 연결된 클립/미디어 ID |
| track | TrackType | O | 트랙 타입 |
| position | number | O | 시작 위치 (초) |
| duration | number | O | 길이 (초) |
| startTime | number | X | 원본 시작 시간 (트림용) |
| endTime | number | X | 원본 끝 시간 (트림용) |
| speed | number | X | 재생 속도 (0.1~8, video 전용) |
| volume | number | X | 원본 오디오 볼륨 (0~1, video 전용) |
| audioMuted | boolean | X | 음소거 (video 전용) |
| transitions | {in: TransitionType, out: TransitionType} | X | 전환 효과 (video 전용) |
| textContent | string | X | 텍스트 내용 |
| textFont | string | X | 폰트 |
| textFontSize | number | X | 폰트 크기 (px) |
| textColor | string | X | 텍스트 색상 (hex) |
| textAlign | 'left' \| 'center' \| 'right' | X | 정렬 |
| textBold | boolean | X | 굵게 |
| textItalic | boolean | X | 기울임 |
| textUnderline | boolean | X | 밑줄 |
| textAnimation | TextAnimationType | X | 텍스트 애니메이션 |
| textPosition | {x: number, y: number} | X | 위치 (0~100%) |
| audioVolume | number | X | 오디오 볼륨 (0~100) |
| audioMuted | boolean | X | 오디오 음소거 |
| audioBgm | {id, name, volume} | X | BGM 정보 |
| filterPreset | string | X | 필터 프리셋명 |
| filterBrightness | number | X | 밝기 (-100~100) |
| filterContrast | number | X | 대비 (-100~100) |
| filterSaturation | number | X | 채도 (-100~100) |
| filterTemperature | number | X | 색온도 (-100~100) |
| stickerEmoji | string | X | 스티커 이모지 |
| stickerAnimation | StickerAnimationType | X | 스티커 애니메이션 |
| stickerScale | number | X | 스티커 크기 (0.5~3) |
| stickerPosition | {x: number, y: number} | X | 위치 (0~100%) |

**TrackType:** `'video' | 'text' | 'audio' | 'filter' | 'sticker'`
**TransitionType:** `'none' | 'fade' | 'slide' | 'zoom'`
**TextAnimationType:** `'none' | 'fade-in' | 'fade-out' | 'slide-up' | 'slide-down' | 'slide-left' | 'slide-right' | 'zoom-in' | 'bounce' | 'typewriter' | 'glow'`
**StickerAnimationType:** `'none' | 'bounce' | 'spin' | 'pulse' | 'shake'`

---

## API 명세

> `[TBD]` 표시된 항목은 백엔드 설계 시 확정 필요

### 인증

| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/api/auth/login` | 로그인 `[TBD]` |
| POST | `/api/auth/logout` | 로그아웃 |
| GET | `/api/auth/me` | 현재 사용자 정보 |

### 사용자

| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| GET | `/api/users/{id}` | 사용자 정보 조회 |
| PATCH | `/api/users/{id}` | 사용자 정보 수정 (이름, 테마 등) |

### 미디어

| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| GET | `/api/media` | 미디어 목록 조회 (쿼리: type, sort, page) |
| POST | `/api/media/upload` | 미디어 업로드 (multipart/form-data) |
| DELETE | `/api/media/{id}` | 미디어 삭제 |

### 프로젝트

| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| GET | `/api/projects` | 프로젝트 목록 조회 (sort=updatedAt:desc) |
| POST | `/api/projects` | 프로젝트 생성 (비율, 미디어 목록, 템플릿ID) |
| GET | `/api/projects/{id}` | 프로젝트 상세 조회 (타임라인 포함) |
| PATCH | `/api/projects/{id}` | 프로젝트 수정 (이름, 타임라인) |
| DELETE | `/api/projects/{id}` | 프로젝트 삭제 |
| POST | `/api/projects/{id}/duplicate` | 프로젝트 복제 |

### 내보내기

| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/api/exports` | 렌더링 시작 (projectId, quality, format) |
| GET | `/api/exports/{id}/status` | 렌더링 진행률 조회 |
| DELETE | `/api/exports/{id}` | 렌더링 취소 |
| GET | `/api/exports/{id}/download` | 렌더링 결과 다운로드 URL |

### AI 어시스턴트

| 메서드 | 엔드포인트 | 설명 |
|--------|-----------|------|
| POST | `/api/ai/analyze` | 샷 데이터 기반 추천 생성 (shotData 입력) |

---

## 에러 처리

### 네트워크 에러

| 상황 | UI 처리 |
|------|---------|
| 요청 타임아웃 (30초) | "요청 시간이 초과되었습니다" (error 토스트) + 재시도 |
| 서버 에러 (5xx) | "서버 오류가 발생했습니다" (error 토스트) |
| 네트워크 끊김 | "네트워크 연결을 확인해주세요" (error 토스트) |
| 401 Unauthorized | 로그인 페이지로 리다이렉트 |
| 403 Forbidden | "접근 권한이 없습니다" (error 토스트) |
| 404 Not Found | "해당 항목을 찾을 수 없습니다" (error 토스트) |

### 미디어 업로드 에러

| 상황 | UI 처리 |
|------|---------|
| 파일 크기 초과 | "파일 크기가 너무 큽니다 (최대 {N}MB)" (warning 토스트) |
| 지원하지 않는 포맷 | "지원하지 않는 파일 형식입니다" (warning 토스트) |
| 업로드 중 실패 | "업로드에 실패했습니다. 다시 시도해주세요" (error 토스트) |
| 스토리지 용량 초과 | "저장 공간이 부족합니다" (error 토스트) |

### 에디터 에러

| 상황 | UI 처리 |
|------|---------|
| 자동 저장 실패 | 저장 상태를 "미저장"으로 유지 + 5초 후 재시도 |
| 프로젝트 로딩 실패 | "프로젝트를 불러올 수 없습니다" → 대시보드로 복귀 |
| 렌더링 실패 | "만들기에 실패했습니다" (error 토스트) → 설정 화면으로 복귀 |

---

> **`[TBD]` 항목 요약**: 이 문서에서 `[TBD]`로 표시된 항목은 기획/인프라 결정이 필요한 사항입니다.
> 개발 착수 전 해당 항목들의 의사결정을 완료해주세요.
>
> **프로토타입 참조**: https://noah8010.github.io/golfsnap_00/
> 이 문서와 함께 프로토타입을 직접 조작하여 인터랙션을 확인하시기 바랍니다.
